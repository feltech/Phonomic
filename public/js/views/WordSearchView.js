// Generated by CoffeeScript 1.6.3
define(['jquery', 'brite', 'template/WordSearch', 'template/WordSearchList', 'utils/logger', 'models/WordSearchModel', 'lib/jquery/jquery.transit'], function($, brite, searchTmpl, listTmpl, log, WordSearchModel) {
  return brite.registerView('WordSearch', {
    create: function() {
      this.model = brite.registerDao(new WordSearchModel);
      return searchTmpl.render();
    },
    events: {
      'submit; #form-search': function(evt) {
        var $target, text;
        evt.preventDefault();
        $target = $(evt.currentTarget);
        $('#error-log').bEmpty();
        text = $('input', $target).val();
        this.$el.trigger('search', {
          text: text
        });
        return false;
      }
    },
    docEvents: {
      'search': function(evt, data) {
        return this.model.list(data.text).fail(function(xhr) {
          return $('#error-log').append(xhr.responseText);
        });
      }
    },
    daoEvents: {
      'result; WordSearchModel': function(evt) {
        $('#right-panel').hide().html(listTmpl.render({
          words: evt.daoEvent.result
        })).css({
          x: $(window).width()
        }).show().transition({
          x: 0
        }, 300, 'snap');
        if (log('debug')) {
          console.debug(JSON.stringify(evt.daoEvent));
        }
      }
    }
  });
});
